Protocol: Search

Types:
    Agent A, B;
    Number Query, NA, NB;
    Function pk, sk, pw, h;

Knowledge:
    A: A, B, pw(A,B), pk(B), h;
    B: A, B, pw(A,B), pk(B), inv(pk(B)), h;

Actions:

    A -> B: {A, NA, pw(A,B), h(pw(A,B), NA)}pk(B)

    B -> A: {|B, NB, NA|}h(pw(A,B), NA)

    A -> B: {|Query, NB, NA, A, B|}h(pw(A,B), NA)

    B -> A: {|NB, NA, A, B|}h(pw(A,B), NA)

Goals:
    B authenticates A on Query;
    A authenticates B on Query;
    Query secret between A, B;
